---
title: Flyweight(í”Œë¼ì´ì›¨ì´íŠ¸) íŒ¨í„´
tags:
  - ë””ìì¸íŒ¨í„´
  - êµ¬ì¡°íŒ¨í„´
---

> ì‘ì„±ì : ì „íš¨í¬

<!--more-->

<hr>


### Flyweight(í”Œë¼ì´ì›¨ì´íŠ¸) íŒ¨í„´

	ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ëŠ¥í•œ í•œ ê³µìœ í•´ì„œ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½í•˜ëŠ” íŒ¨í„´

<!--more-->


### ğŸ‘¿ ë¬¸ì œìƒí™©

	ë§ˆì¸í¬ë˜í”„íŠ¸ ê²Œì„ì— ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤. 



	ë‚˜ë¬´ëŠ” ìƒ‰(color)ì„ ì •í•  ìˆ˜ ìˆê³ , íŠ¹ì • ìœ„ì¹˜(x, y)ì— ì„¸ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
	
	ë§Œì•½ ë‚´ê°€ ë§ˆí¬ì— ë¯¸ì³ì„œ ë‚˜ë¬´ 10000ê°œë¥¼ ë§µì— ì‹¬ëŠ”ë‹¤ê³  í•  ë•Œ, 
	
	ë‚˜ë¬´ í•œ ê·¸ë£¨ì— ë“¤ì–´ê°€ëŠ” ë°ì´í„°ëŠ”
	
	color : 4Byte , x: 4byte, y:4byte ë¼ê³  í•©ì‹œë‹¤.
	
	ëª¨ë“  ë‚˜ë¬´ë¥¼ ì‹¬ì„ ë•Œë§ˆë‹¤ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤ë©´, ë‚˜ë¬´ 10,000ê°œì—ëŠ” 120,000byte ê°€ ë“­ë‹ˆë‹¤.

![](https://images.velog.io/images/hoit_98/post/80015d98-c611-4252-8cde-0f4601769d85/image.png)

	ë” ë§ˆí¬ì— ì—´ê´‘í•˜ëŠ” ì‚¬ëŒë“¤ì€ ë” ë§ì€ ë‚˜ë¬´ë¥¼ ì„¸ìš¸í…ë°,, ë‚˜~~~ì¤‘ì—ëŠ” ë©”ëª¨ë¦¬ê°€ í„°ì§ˆìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.



### ğŸ˜‡ ì–´ë–»ê²Œ í•´ê²°í• ê¹Œ

	ëª¨ë“  ë‚˜ë¬´ì˜ x, yëŠ” ë‹¤ë¥´ì§€ë§Œ ë‚˜ë¬´ ìƒ‰ì€ í•­ìƒ ë°”ë€” í•„ìš”ëŠ” ì—†ì£ ? ê±°ì˜ ê°™ê³  ê°€ë” ìƒ‰ ë°”ê¾¸ê²Œ ë©ë‹ˆë‹¤.
	
	ê·¸ëŸ¬ë©´ ë‚˜ë¬´ë¥¼ ê³„ì† ìƒˆë¡œ ë§Œë“¤ì§€ ë§ê³ ,, ì €ì¥í•´ë†¨ë‹¤ê°€ ê°€ì ¸ë‹¤ ì“°ëŠ” ì‹ìœ¼ë¡œ í•œë‹¤ë©´??


![](https://images.velog.io/images/hoit_98/post/953ebe1d-262c-4983-9d5e-408335881658/image.png)

	ê·¸ëŸ¬ë©´ ìƒˆë¡œìš´ ìƒ‰ìƒì˜ ë‚˜ë¬´ê°€ ì¶”ê°€ë  ë•Œë§Œ ìƒˆ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤ë©´
	
	ë‚˜ë¬´ê°€ **10000ê°œ ì—¬ë„ 12 * (ìƒˆë¡œìš´ ìƒ‰ìƒì„ ì¶”ê°€í•œ íšŸìˆ˜) byte** ì´ë ‡ê²Œ ë³€í•˜ê² ë„¤ìš”!
	
	ë‚´ê°€ ë§Œì•½ ìƒ‰ì„ 2ê°œë§Œ ì“´ë‹¤ë©´ 24byte ì´ë‹ˆê¹Œ ì´ì „ë³´ë‹¤ 119976byte ê°€ëŸ‰ ì ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!
	
	ë‚˜ë¬´ ìˆ˜ê°€ ë§ì„ ìˆ˜ë¡ ë” ì ˆì•½í•  ìˆ˜ ìˆê² ë„¤ìš”!
	
	ì´ë ‡ê²Œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ëŠ¥í•œëŒ€ë¡œ ê³µìœ ì‹œì¼œì„œ ì“¸ë°ì—†ëŠ” newë¥¼ í†µí•œ ë©”ëª¨ë¦¬ ë‚­ë¹„ë¥¼ ì¤„ì´ëŠ”ê²ƒì´ Flyweight íŒ¨í„´ì…ë‹ˆë‹¤!



### ğŸ¤” êµ¬í˜„ì„ ì–´ë–»ê²Œ í• ê¹Œ

	í”Œë¼ì´ì›¨ì´íŠ¸ íŒ¨í„´ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì•„ë˜ 3ê°€ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.

1. ì‹¤ì œ ê³µìœ ë  ê°ì²´ (ë‚˜ë¬´)

2. ê°ì²´ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ê³µìœ í•´ì£¼ëŠ” íŒ©í† ë¦¬(Factory) 

   -> ê°™ì€ ìƒ‰ì˜ ë‚˜ë¬´ê°€ ì—†ë‹¤ë©´ ìƒˆë¡œ ìƒì„±í•˜ê³ , ìˆë‹¤ë©´ ê·¸ ìƒ‰ì˜ ë‚˜ë¬´ë¥¼ ë°˜í™˜í•´ì¤ë‹ˆë‹¤.

3. íŒ¨í„´ì„ ì‚¬ìš©í•  ê³ ê°, í´ë¼ì´ì–¸íŠ¸ 

   -> ìš°ë¦¬ëŠ” ê·¸ëƒ¥ 2ë²ˆì—ê²Œ OOìƒ‰ ë‚˜ë¬´ë¥¼ ìš”ì²­í•˜ê³ , ë°›ì•„ì„œ X,Yë¥¼ ì„¤ì •í•˜ê³  ì„¤ì¹˜í•˜ë©´ ë©ë‹ˆë‹¤.

   

### ğŸ“œ ì½”ë“œë¡œ ì‚´í´ë³¼ê¹Œìš”!

1. ê³µìœ í•  Tree ê°ì²´

```java
public class Tree {

    // ë‚˜ë¬´ëŠ” ì•„ë˜ì™€ ê°™ì´ 3ê°œ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
    private String color;
    private int x;
    private int y;

    //ìƒ‰ìƒìœ¼ë¡œë§Œ ìƒì„±ìë¥¼ ë§Œë“¤ì–´ì¤„ê²Œìš”.
    public Tree(String color) {
        this.color = color;
    }

    public void setX(int x) {
        this.x = x;
    }

    public void setY(int y) {
        this.y = y;
    }

    //ë‚˜ë¬´ë¥¼ ì‹¬ì„ ë•Œ
    public void install(){
        System.out.println("x:"+x+" y:"+y+" ìœ„ì¹˜ì— "+color+"ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!");
    }
}
```

   

  2. Treeë¥¼ ì œê³µí•´ì¤„  TreeFactory

```java
public class TreeFactory {
    //HashMap ìë£Œêµ¬ì¡°ë¥¼ í™œìš©í•´ì„œ ë§Œë“¤ì–´ì§„ ë‚˜ë¬´ë“¤ì„ ê´€ë¦¬í•´ë³¼ê²Œìš”
    public static final HashMap<String, Tree> treeMap = new HashMap<>();
    
   
    public static Tree getTree(String treeColor){
        //Mapì— ì…ë ¥ë°›ì€ ìƒ‰ìƒì˜ ë‚˜ë¬´ê°€ ìˆëŠ”ì§€ ì°¾ìŠµë‹ˆë‹¤. ìˆìœ¼ë©´ ê·¸ ê°ì²´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
        Tree tree = (Tree)treeMap.get(treeColor); 

       //ë§Œì•½ ì•„ì§ ê°™ì€ ìƒ‰ìƒì˜ ë‚˜ë¬´ê°€ Mapì— ì—†ë‹¤ë©´ ìƒˆë¡œ ê°ì²´ë¥¼ ìƒì„±í•´ ì œê³µí•©ë‹ˆë‹¤.
        if(tree == null){
            tree = new Tree(treeColor);
            treeMap.put(treeColor, tree);
            System.out.println("ìƒˆ ê°ì²´ ìƒì„±");
        }

        return tree;
    }
}
```

â€‹    

  3. ì‚¬ìš©í•  ê³ ê°

```java
import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println("ì›í•˜ëŠ” ìƒ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš” :)");
        for(int i=0;i<10;i++){
            //ë‚˜ë¬´ ìƒ‰ ì…ë ¥ë°›ê¸°
            String input = scanner.nextLine();
            //íŒ©í† ë¦¬ì—ì„œ ë‚˜ë¬´ í•˜ë‚˜ ê³µê¸‰ë°›ê¸°
            Tree tree = (Tree)TreeFactory.getTree(input);
            //ë‚˜ë¬´ x,y ì„¤ì •í•˜ê³ 
            tree.setX((int) (Math.random()*100));
            tree.setY((int) (Math.random()*100));
            //ë‚˜ë¬´ ì„¤ì¹˜í•˜ê¸°
            tree.install();
        }

    }
}
```



 ğŸ’» ê²°ê³¼

**ë‹¤ë¥¸ ìƒ‰ìƒì´ ë“¤ì–´ì˜¬ ë•Œë§Œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤!**

```shell
ì›í•˜ëŠ” ìƒ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš” :)
ì´ˆë¡
ìƒˆë¡œìš´ ê°ì²´ ìƒì„±
x:47 y:55 ìœ„ì¹˜ì— ì´ˆë¡ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì—°ë‘
ìƒˆë¡œìš´ ê°ì²´ ìƒì„±
x:86 y:33 ìœ„ì¹˜ì— ì—°ë‘ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì´ˆë¡
x:62 y:30 ìœ„ì¹˜ì— ì´ˆë¡ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì´ˆë¡
x:83 y:21 ìœ„ì¹˜ì— ì´ˆë¡ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì´ˆë¡
x:47 y:46 ìœ„ì¹˜ì— ì´ˆë¡ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì—°ë‘
x:49 y:59 ìœ„ì¹˜ì— ì—°ë‘ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì—°ë‘
x:10 y:38 ìœ„ì¹˜ì— ì—°ë‘ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì¹´í‚¤
ìƒˆë¡œìš´ ê°ì²´ ìƒì„±
x:78 y:39 ìœ„ì¹˜ì— ì¹´í‚¤ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì¹´í‚¤
x:21 y:41 ìœ„ì¹˜ì— ì¹´í‚¤ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
ì¹´í‚¤
x:58 y:26 ìœ„ì¹˜ì— ì¹´í‚¤ìƒ‰ ë‚˜ë¬´ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤!
```

### â“ ì‹±ê¸€í†¤ íŒ¨í„´ê³¼ ë‹¤ë¥¸ê²Œ ë­ì£ ?

 - ì‹±ê¸€í†¤ ì—­ì‹œ ê°ì²´ë¥¼ í•˜ë‚˜ë§Œ ìƒì„±í•˜ê³  í™œìš©í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.
   ë‘˜ì˜ ë‹¤ë¥¸ ì ì€ ë­˜ê¹Œìš”?
   ìš°ë¦¬ì˜ ë‚˜ë¬´ ì˜ˆì‹œë¥¼ ìƒê°í•´ë³¼ê¹Œìš”?

* 

  ìš°ë¦¬ê°€ ì œì‘í•œ **Flyweight íŒ¨í„´**ì—ì„œ,
  ë‚˜ë¬´ëŠ” ìƒ‰ê¹”ì´ ë°”ë€” ë•Œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
  ìƒ‰ìƒ ë³„ë¡œ í•˜ë‚˜ì”©, ê²°ê³¼ì ìœ¼ë¡œëŠ” ì—¬ëŸ¬ê°œì˜ ë‚˜ë¬´ê°€ ìƒê¹ë‹ˆë‹¤.
  ë˜í•œ ë§Œë“¤ì–´ì§„ ê°ì²´ì˜ ìƒ‰ìƒì€ ë°”ê¿€ ìˆ˜ ì—†ëŠ” ì¼ì…ë‹ˆë‹¤.
  ë”°ë¼ì„œ **í•˜ë‚˜ì”© ì—¬ëŸ¬ì¢…ë¥˜**ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ê·¸ëŸ¬ë‚˜ **ì‹±ê¸€í†¤ íŒ¨í„´**ì´ë¼ë©´,
  ë‚˜ë¬´ í´ë˜ìŠ¤ì— ë‹¨ í•œê°œì˜ ë‚˜ë¬´ë§Œ ë§Œë“¤ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  ë”°ë¼ì„œ ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì‚¬ìš©í•œë‹¤ë©´,
  ë§Œë“¤ì–´ì§„ ë‹¨ í•˜ë‚˜ì˜ ê°ì²´(ë‚˜ë¬´)ì˜ ìƒ‰ê¹”ì„ ë°”ê¿”ì•¼ë§Œí•©ë‹ˆë‹¤. 
  ì‹±ê¸€í†¤ì€ ì´ë ‡ë“¯ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì— ë‹¨ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , ëŒ€ì‹  ë³€ìˆ˜ë¥¼ í•„ìš”ì‹œ ë³€ê²½í•´ê°€ë©° ì“¸ ìˆ˜ ìˆë‹¤ëŠ” ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.
  ë”°ë¼ì„œ ì‹±ê¸€í†¤ íŒ¨í„´ì€ **ì¢…ë¥˜ ìƒê´€ì—†ì´ ë‹¨ í•˜ë‚˜ë§Œ** ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### ğŸ˜ ë©‹ì§„ ì‚¬ì‹¤

ì‚¬ì‹¤ í”Œë¼ì´ì›¨ì´íŠ¸ íŒ¨í„´ì€ Javaì˜ String Constant Poolì— ì ìš©ë©ë‹ˆë‹¤...!

ìë°”ì˜ Stringì€ ë§Œë“¤ì–´ì§ˆë•Œ String Constant Poolì— ì €ì¥ë˜ì–´ 

ê°™ì€ ë¬¸ìì—´ì´ poolì— ìˆë‹¤ë©´ ì´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ì‹ìœ¼ë¡œ ë˜ì–´ìˆìŠµë‹ˆë‹¤!

(ê´€ë ¨ ë‚´ìš©ì„ ì •ë¦¬í–ˆë˜ ì œ ë¸”ë¡œê·¸ ê¸€ : [ë§í¬](https://velog.io/@hoit_98/Assignment-StringBuffer-and-String-Builder) ) 

ë”°ë¼ì„œ String classëŠ” Flyweight íŒ¨í„´ì„ ì ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!!


------

### ğŸ’• ì°¸ê³ í•œ ë§í¬ë“¤

1. ê¸°ë³¸ì ì¸ íŒ¨í„´ ì„¤ëª… + ìš©ëŸ‰ ì ˆì•½ì— ëŒ€í•œ ë‚´ìš©(ë¦¬íŒ©í† ë§ ê·¸ë£¨)

   https://refactoring.guru/design-patterns/flyweight

2. í”Œë¼ì´ì›¨ì´íŠ¸ íŒ¨í„´ì˜ ìë°” êµ¬í˜„ ì˜ˆì œ

   https://lee1535.tistory.com/106

3. í”Œë¼ì´ì›¨ì´íŠ¸ íŒ¨í„´ê³¼ String Constant Poolì— ëŒ€í•œ ë‚´ìš©

   https://it-mesung.tistory.com/183

4. ë‚˜ë¬´ ì˜ˆì œì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©

   https://m.blog.naver.com/2feelus/220669069127

5. ì‹±ê¸€í†¤ê³¼ì˜ ë¹„êµ
   https://medium.com/remember/flyweight-pattern-f02c771a72fb

### ğŸ¥° ë§Œë“  ì´(ì „íš¨í¬) ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸: [ë§í¬](https://velog.io/@hoit_98/%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4-Flyweight-%ED%8C%A8%ED%84%B4)
